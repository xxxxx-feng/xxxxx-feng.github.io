输入URL发生了什么?

1. 在浏览器地址栏输入URL
2. 浏览器查看缓存，请求资源在缓存中并且未过期，跳转到转码步骤 如果浏览器未缓存，发起新的请求已缓存，检验是否过期，未过期直接提供给客户端，否则进行验证检验是否过期 通常有两个http头进行控制，expires和cache-control。
3. 浏览器解析URL获取协议，主机，端口，path
4. 浏览器组装一个http请求 请求报文
5. 浏览器获取主机ip地址：(dns解析过程)过程：浏览器缓存 -> 本地缓存-> hosts文件 -> 路由器缓存 -> ISP DNS缓存 -> DNS递归查询
6. 打开一个socket与目标地址建立TCP连接，进行三次握手i. 客户端发送一个TCP的SYN=1，Sep=X的包到服务器端口ii. 服务器返回SYN=1，ACK=X+1，Sep=Y的响应包iii. 客户端发送ACK=Y+1，Sep=Z
7. TCP连接建立发送http请求。
8. 服务器接收请求并解析，将请求转发到服务程序
9. 服务器检查http请求头是否包含缓存验证信息，如果验证缓存新鲜，返回304等对应状态码
10. 处理程序读取完整请求并准备http响应，可能需要查询数据库等操作
11. 服务器将响应报文通过TCP连接发送回浏览器
12. 浏览器接收到http响应，然后根据情况选择关闭TCP连接或者保留重用。（关闭操作进行第四次挥手）主动方发送Fin=1，Ack=Z，Sep=X的报文被动方发送ACK=X+1，Sep=Z报文被动方发送Fin=1，ACK=X，Sep=Y报文主动方发送ACK=Y，Sep=X报文
13. 浏览器检查响应状态码。状态码不同 解决的方法不同 1XX 3XX 4XX 5XX区别对待2XX是正常返回
14. 如果资源可缓存，进行缓存
15. 对响应解码 例如gzip压缩
16. 根据资源类型决定如何处理
17. 假设资源为html文档
18. 解析html文档 构建dom树 下载资源，构建css树，执行js脚本
19. 构建dom树
20. 解析过程遇到图片、样式表、js文件、启动下载
21. 构建css树
22. 根据dom树和css树整合构建渲染树
23. js解析
24. 显示页面

![800003022.jpg](https://gitee.com/hejf01/pic/raw/master//url渲染过程.webp)
